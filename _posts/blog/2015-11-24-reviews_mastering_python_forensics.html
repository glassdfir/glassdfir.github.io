---
layout: post
title: Review Of Mastering Python Forensics
date: 2015-11-24 21:01:16.000000000 -05:00
categories: blog
---
On October 30th, <span style="text-decoration: underline;"><a href="https://twitter.com/m_spreitz" target="_blank">Dr. Michael Spreitzenbarth</a></span> and <span style="text-decoration: underline;"><a href="https://twitter.com/uhrmann" target="_blank">Dr. Johann Uhrmann</a></span> released <span style="text-decoration: underline;"><a href="http://shop.oreilly.com/product/9781783988044.do" target="_blank">Mastering Python Forensics</a></span>.<br />
 Here are a few of my thoughts on it...

<h3>Chapter 1: Setting Up the Lab and Introduction to Python ctypes</h3>
<p>I enjoyed learning about Python virtualenv. For those that don’t know, Virtual Environment is a tool to keep the dependencies required by different projects in separate places by creating virtual Python environments for them. This helps when packaging tools for distribution. This book does a excellent job of explaining the basics and incorporates virtualenv throughout all of examples in the text. Here is a great rundown I discovered <a href="http://docs.python-guide.org/en/latest/dev/virtualenvs/" target="_blank">this nice write up</a>.<br />
The Introduction to Python ctypes was worth reading 3 or 4 times. I have been using ctypes and structs in Python for a while but this chapter helped organize and clarify the "copy and paste" knowledge I was working with. I expect to use the portion about interacting with DLLs as a reference numerous times in the pursuit of reverse engineering malware.</p>
<p>For me, this first chapter alone was worth the cost of the book. I think I can leverage the principles covered in this chapter to do some interesting stuff.</p>
<h3>Chapter 2 , Forensic Algorithms</h3>
<p>While chapter is surely a necessary topic for beginners, it was not particularly revolutionary for me. They did a great job of covering the subject though. I did like the addition of a Python client for <a href="https://rjhansen.github.io/nsrlsvr" target="_blank">nsrlsvr</a> to compare files hashes against list of known files provided by the good people at <a href="http://www.nsrl.nist.gov" target="_blank">NIST</a>. That might come in handy.</p>
<h3>Chapter 3 , Using Python for Windows and Linux Forensics</h3>
<p>This is a deep subject to cover in one chapter. This chapter highlights one of the things I like the most about this book: it leans on assumed knowledge by quickly covering the foundations and moves on to advanced topics. This is not a "basics of forensics" or "Python for Dummies" style of book but it covers enough to still be inclusive for the ambitious novice. This chapter:</p>
<ul>
<li>does a great job explaining how to use <a href="https://github.com/williballenthin/python-evtx" target="_blank">Willi Ballenthin's Python-EVTX</a> to parse the Windows Registry and search for Indicators of Compromise.</li>
<li>does feature a small blurb about <a href="https://github.com/log2timeline/plaso/wiki" target="_blank">plaso and log2timeline tools</a>. For what it is worth, I would have liked to see more from this project but, again, they had a lot of ground to cover so I understand the brevity.</li>
<li>covers the Windows Registry structure, and highlights of what to look for in the registry. This chapter fails to mention Mr. Ballenthin's <a href="http://www.williballenthin.com/registry/" target="_blank">Python-Registry</a> module and the resulting Python Registry Parser from Patrick Olsen both I think are missed opportunities. It does cover Andrew Davis' <a href="https://github.com/mandiant/ShimCacheParser/blob/master/ShimCacheParser.py" target="_blank">ShimCacheParser</a> which uses an old version of Ballenthin's Registry module. The surface was scratched but in my opinion, they could have dug a little deeper.</li>
<li>nails Linux Forensics 101 with Python perfectly. I have nothing but praise for this section of the book. It is rich with practical examples and insightful explanations.</li>
<li>does a good job of using matplotlib to visualize data with histograms. The method demonstrated could be leveraged to display all kinds of data.</li>
</ul>
<h3>Chapter 4 , Using Python for Network Forensics</h3>
<p>This chapter is short and doesn't cover as much ground as I would have hoped. This chapter:</p>
<ul>
<li>Introduces <a href="https://github.com/USArmyResearchLab/Dshell" target="_blank">Dshell</a> to dissect packet captures. I learned a lot from this section and see a lot of practical applications for the examples provided. Dshell makes carving files out pcaps easy peasy.</li>
<li>Offers an example of using <a href="http://www.secdev.org/projects/scapy/" target="_blank">Scapy</a> for during a forensic investigation. The script they provide records the statistics about the geolocation of the IP address source and the destination of an ongoing network connection. While this seems cool, this falls more into the realm of Incident Response than Forensics.</li>
<li>Explains how to use Scapy to create a simple port scanner. Building a port scanner for a Forensic investigation feels like a stretch to me. Again, I feel like this is more suited for IR or Penetration Testing. Neat though.</li>
<li>I would have loved to see more deep packet analysis or visualization of traffic patterns. Perhaps decrypting CryptoWall's RC4 C&amp;C traffic in Python? Just a thought.</li>
<li>For the next edition, newer projects like <a href="https://twitter.com/omriher" target="_blank">Omri Herscovici's</a> <a href="https://github.com/omriher/CapTipper" target="_blank">CapTipper</a> would make a fine addition.</li>
</ul>
<h3>Chapter 5 , Using Python for Virtualization Forensics</h3>
<p>Chapter 5 is well executed and covered topic thoroughly. This is another chapter that made me glad I bought the book though I will be the first to admit that I didn't lob any of the example scripts at an actual VMware vSphere environment. I enjoyed this portion of the book because it describes an area of digital forensics that is outside of my usual wheelhouse. This chapter describes how to use <a href="https://github.com/vmware/pyvmomi" target="_blank">pyVmomi</a>, VMware's Python SDK for the vSphere API, to analyze ESX, ESXi, or vCenter systems for the creation of rogue virtual machines, the creation of rogue virtual network devices on existing virtual machines, and enumerating virtual machines' direct hardware access. Pretty cool stuff. Since I am more of a VMware Workstation/Fusion type of guy , I have done similar things from using the <a href="https://www.vmware.com/pdf/vix162_vmrun_command.pdf" target="_blank">vmrun command line interface</a>.</p>
<h3>Chapter 6 , Using Python for Mobile Forensics</h3>
<p>I am <strong>not a seasoned mobile forensics analyst</strong> but I struggle with the mechanics of rooting an android phone in the pursuit of a forensic investigation.I say all that to say this, to me it seems like the introduction of an exploit to jailbreak or root your mobile device would not only be a tough sell in court but would trample all over filesystem metadata during the rooting process. I have some experience using <a href="http://www.cellebrite.com/collateral/Explaining_Cellebrite_UFED_Data_Extraction_Processes.pdf" target="_blank">Cellebrite's</a> equipment to perform logical extractions of Blackberries and Android devices which doesn't dig deep but also doesn't compromise the device either.</p>
<p>For the record, I am familiar with rooting. I rooted all four of my Motorola Droids (Droid 1-4)(I was a sucker for the sliding keyboard. Don't judge me) and my Motorola Xoom (Motorola had me in their clutches for a while). Like many earlier android rooters, I pretty much only rooted my phone to install hacking tools and use the phone as a Wifi hotspot. Once the mobile hotspot became a mainstream feature and rooting because an enormous pain in the ass, I stopped scouring the android forums for hours trying to find shady recovery images and poorly written instructions for my exact model of phone. All things being considered, it was a good turning point in my life. I digress...</p>
<p>This chapter assumes you have rooted/jailbroken your device so, tabling all of my silly apprehensions about compromising the device, I found this to be another very interesting chapter. It covers using Python to grab the hash of the screen pin and cracking the hash with <a href="http://hashcat.net/oclhashcat/" target="_blank">hashcat</a> to unlock the screen. I could see this being very handy. Overall, I see enormous practicality in the examples provided in this chapter. I was previously unaware of the <a href="http://mspreitz.github.io/ADEL/" target="_blank">ADEL project</a> and I haven't evaluated it but upfront it says it works on Android 4.X. I wonder if the development of this tool and tools like are keeping up with the versions of Android. As of October 5th, we are up to Android 6.0 Marshmallow. The project looks awesome for the record and this book does a great job of explaining the applications.</p>
<h3>Chapter 7 , Using Python for Memory Forensics</h3>
<p>This is not the <a href="http://www.amazon.com/The-Art-Memory-Forensics-Detecting/dp/1118825098" target="_blank">Art of Memory Forensics</a> and it doesn't try to be. I like that. The subject of analyzing Windows memory images with <a href="https://github.com/volatilityfoundation" target="_blank">Volatility</a> is covered, in depth, all over the place so I appreciate that this book doesn't attempt to cover it. Smart move. Instead it offers examples of how to analyze volatile memory from Android and Linux devices. By targeting this subset of Volatility's functionality, I think it adds a lot of value to this text. This chapter was another that broadened my horizons and made me glad I purchased.</p>
<h3>Conclusion</h3>
<p>If you are someone that would read this blog, you should buy this book.  This book is easy to digest and a wonderful starting point for DFIR professionals that are interested in leveraging Python to accomplish their work. "Forensics with Python" is a broad and ambitious topic to cover in 192 pages with diagrams and source code. Spreitzenbarth and Uhrmann did an impressive job of tackling the variety of subjects in an appropriate level of detail to make this book useful for forensic analysts of any experience level. Well done.</p>
