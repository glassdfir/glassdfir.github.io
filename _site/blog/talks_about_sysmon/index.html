<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>SysMon! &#8211; Half Full of Security</title>
<meta name="description" content="">
<meta name="keywords" content="">


<!-- Twitter Cards -->
<meta name="twitter:title" content="SysMon!">
<meta name="twitter:description" content="">
<meta name="twitter:site" content="@GlassDFIR">
<meta name="twitter:creator" content="@GlassDFIR">

<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://localhost:4000/images/site-logo.png">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="SysMon!">
<meta property="og:description" content="">
<meta property="og:url" content="http://localhost:4000/blog/talks_about_sysmon/">
<meta property="og:site_name" content="Half Full of Security">





<link rel="canonical" href="http://localhost:4000/blog/talks_about_sysmon/">
<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="Half Full of Security Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">
<!-- Webfonts -->
<script src="https://use.edgefonts.net/source-sans-pro:n2,i2,n3,i3,n4,i4,n6,i6,n7,i7,n9,i9;source-code-pro:n4,n7;volkhov.js"></script>

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
  <script src="http://localhost:4000/assets/js/vendor/html5shiv.min.js"></script>
  <script src="http://localhost:4000/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="http://localhost:4000/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>


<!-- MathJax -->
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://localhost:4000/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://localhost:4000/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://localhost:4000/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:4000/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body id="post">

<div class="navigation-wrapper">
	<nav role="navigation" id="site-nav" class="animated drop">
	    <ul>
      
		    
		    <li><a href="http://localhost:4000/blog/" >Blog</a></li>
		  
		    
		    <li><a href="http://localhost:4000/adfirwmc/" >ADFIRWMC</a></li>
		  
		    
		    <li><a href="http://localhost:4000/tips/" >Tips and Tricks</a></li>
		  
		    
		    <li><a href="http://localhost:4000/about/" >About</a></li>
		  
		    
		    <li><a href="http://localhost:4000/search/" >Search</a></li>
		  
	    </ul>
	</nav>
</div><!-- /.navigation-wrapper -->

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->

<header class="masthead">
	<div class="wrap">
      
  		<a href="http://localhost:4000/" class="site-logo" rel="home" title="Half Full of Security"><img src="http://localhost:4000/images/site-logo.png" width="200" height="200" alt="Half Full of Security logo" class="animated fadeInDown"></a>
      
      <h1 class="site-title animated fadeIn"><a href="http://localhost:4000/">Half Full of Security</a></h1>
		<h2 class="site-description animated fadeIn" itemprop="description">Sharpening the ACKs since 2013</h2>
	</div>
</header><!-- /.masthead -->

<div class="js-menu-screen menu-screen"></div>


<div id="main" role="main">
  <article class="hentry">
    
    <div class="entry-wrapper">
      <header class="entry-header">
        <ul class="entry-tags">
          
        </ul>
        
          <h1 class="entry-title">SysMon!</h1>
        
      </header>


        <time datetime="2014-08-29T07:24:59+00:00"><i class="fa fa-calendar-o"></i> August 29, 2014</time>
        <p>The Microsoft Sysinternals team recently released System Monitor (<a href="http://technet.microsoft.com/en-us/sysinternals/dn798348.aspx">Sysmon</a>), a Windows system service and device driver that, once installed on a system, remains resident across system reboots to monitor and log system activity to the Windows event log. It provides detailed information about process creations, network connections, and changes to file creation time.</p>
<p>The timing of this release could not have worked out better for me because I had just spent two weeks reviewing Bit9's <a href="https://www.bit9.com/solutions/carbon-black/">CarbonBlack</a> product. I am not going to provide an in depth review of CarbonBlack here but I found with, a little bit of PowerShell, I could get some similar results out of Sysmon.</p>
<p>****Disclaimer****  This is my first PowerShell project and the coding is rough. You have been warned.</p>
<p>I started with something pretty simple:<br />
<script src="https://gist.github.com/glassdfir/2846607c05079e9bc66a.js"></script><br />
This little script allowed me to search through the Sysmon Event Logs, define a start and stop time, and if the event data matched a keyword, it would return the event to screen.</p>
<p>Example:</p>
<p><strong>PS C:\Users\user\Desktop> .Sysmon.ps1 -StartDate "08/28/2014 21:40" -StopDate "08/28/2014 21:50" -keyword "cmd"</strong></p>
<p><script src="https://gist.github.com/glassdfir/5c13c0eed0c0fe83cea6.js"></script><br />
This was great. From this I can see:</p>
<ol>
<li><script><br />
var a = "c m d.exe";<br />
document.write(a.split(' ').join(''));<br />
</script> being launched from explorer.exe</li>
<li><script><br />
var a = "c m d.exe";<br />
document.write(a.split(' ').join(''));<br />
</script> launching conhost.exe</li>
<li>Ping.exe getting launched from <script><br />
var a = "c m d.exe";<br />
document.write(a.split(' ').join(''));<br />
</script> with the command line of  "Ping google.com"</li>
</ol>
<p>One of the coolest features of CarbonBlack was the ability to visualize/map the process creation over time. So I set out to make something that gave me this functionality using the Sysmon logs. I experimented with a few different graphing technologies and I have currently landed on using <a href="https://developers.google.com/chart/interactive/docs/gallery/orgchart">Google's Org Chart API</a> to do the mapping. I know there are other and probably better ways to do this but I was looking for something high speed/low drag that didn't require installing something.</p>
<p>With this goal in mind, I threw together <a href="https://github.com/glassdfir/SysmonMapper" target="_blank">SysmonMapper</a>. Again, this is some pretty rough PowerShell but it gets the job done.</p>
<p><strong>PS C:Users\user\Desktop&gt; .SysmonMapper.ps1 -StartDate "08/28/2014 21:40" -StopDate "08/28/2014 21:50" -P 4332</strong></p>
<p><a href="https://Jon.Glass/wp-content/uploads/2014/08/sysmonmap.png"><img class="alignnone size-medium wp-image-44" src="/assets/sysmonmap-300x236.png" alt="sysmonmap" width="300" height="236" /></a></p>
<p>Here is another example of sysmonmapper in action: <a href="http://Jon.Glass/wp-content/uploads/2014/08/sysmonmap.html" target="_blank">example</a>.</p>
<p>In the next few weeks I am going throw together some post that will highlight the functionality of this script and show some use cases that demonstrate the  power of visualizing sysmon logs.</p>
<p>&nbsp;</p>

        

    </div><!-- /.entry-wrapper -->
    <nav class="pagination" role="navigation">
      
        <a href="http://localhost:4000/lists-tshark-commands/" class="btn" title="TShark Commands">Previous</a>
      
      
        <a href="http://localhost:4000/blog/shows-more-process-mapping-crap/" class="btn" title="More SysmonMaps and ProcessMapper!">Next</a>
      
    </nav><!-- /.pagination -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo" class="entry-wrapper">
    

<span>&copy; 2023 Jon Glass. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="https://mademistakes.com/work/so-simple-jekyll-theme/" rel="nofollow">So Simple Theme</a>.</span>
<div class="social-icons">
	<a href="https://twitter.com/GlassDFIR" title="Jon Glass on Twitter" target="_blank"><i class="fa fa-twitter-square fa-2x"></i></a>
	
	
	
	
	
	
	<a href="https://github.com/GlassDFIR" title="Jon Glass on Github" target="_blank"><i class="fa fa-github-square fa-2x"></i></a>
	
  
	
  <a href="http://localhost:4000/feed.xml" title="Atom/RSS feed"><i class="fa fa-rss-square fa-2x"></i></a>
</div><!-- /.social-icons -->

  </footer>
</div><!-- /.footer-wrapper -->

<script type="text/javascript">
  var BASE_URL = 'http://localhost:4000';
</script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://localhost:4000/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://localhost:4000/assets/js/scripts.min.js"></script>




</body>
</html>
