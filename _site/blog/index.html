<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Blog &#8211; Half Full of Security</title>
<meta name="description" content="An archive of blog posts sorted by date.">



<!-- Twitter Cards -->
<meta name="twitter:title" content="Blog">
<meta name="twitter:description" content="An archive of blog posts sorted by date.">
<meta name="twitter:site" content="@GlassDFIR">
<meta name="twitter:creator" content="@GlassDFIR">

<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://jon.glass/images/site-logo.png">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Blog">
<meta property="og:description" content="An archive of blog posts sorted by date.">
<meta property="og:url" content="http://jon.glass/blog/">
<meta property="og:site_name" content="Half Full of Security">





<link rel="canonical" href="http://jon.glass/blog/">
<link href="http://jon.glass/feed.xml" type="application/atom+xml" rel="alternate" title="Half Full of Security Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://jon.glass/assets/css/main.css">
<!-- Webfonts -->
<script src="https://use.edgefonts.net/source-sans-pro:n2,i2,n3,i3,n4,i4,n6,i6,n7,i7,n9,i9;source-code-pro:n4,n7;volkhov.js"></script>

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
  <script src="http://jon.glass/assets/js/vendor/html5shiv.min.js"></script>
  <script src="http://jon.glass/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="http://jon.glass/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>


<!-- MathJax -->
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://jon.glass/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://jon.glass/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://jon.glass/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://jon.glass/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://jon.glass/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://jon.glass/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body id="page">

<div class="navigation-wrapper">
	<nav role="navigation" id="site-nav" class="animated drop">
	    <ul>
      
		    
		    <li><a href="http://jon.glass/blog/" >Blog</a></li>
		  
		    
		    <li><a href="http://jon.glass/about/" >About</a></li>
		  
		    
		    <li><a href="http://jon.glass/search/" >Search</a></li>
		  
	    </ul>
	</nav>
</div><!-- /.navigation-wrapper -->

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->

<header class="masthead">
	<div class="wrap">
      
  		<a href="http://jon.glass/" class="site-logo" rel="home" title="Half Full of Security"><img src="http://jon.glass/images/site-logo.png" width="200" height="200" alt="Half Full of Security logo" class="animated fadeInDown"></a>
      
      <h1 class="site-title animated fadeIn"><a href="http://jon.glass/">Half Full of Security</a></h1>
		<h2 class="site-description animated fadeIn" itemprop="description">Sharpening the ACKs since 2013</h2>
	</div>
</header><!-- /.masthead -->

<div class="js-menu-screen menu-screen"></div>


<div id="main" role="main">
  <article class="entry">
    
    <div class="entry-wrapper">
      <header class="entry-header">
        <h1 class="entry-title">Blog</h1>
      </header>
      <div class="entry-content">
        <ul class="post-list">
 
  <li><article><a href="http://jon.glass/blog/RogueUsers/">Dealing with users gone bad… <span class="entry-date"><time datetime="2017-02-03T14:52:28-05:00">February 03, 2017</time></span> <span class="excerpt">We have all been there when someone that gets paid more than you do runs in and says “We need to remove User X from the network and lock them out of their PC to preserve evidence!!!”. If not, you will be.</span></a></article></li>
 
  <li><article><a href="http://jon.glass/blog/Unxoring-a-rat/">UnXORing a RAT <span class="entry-date"><time datetime="2016-02-05T14:52:28-05:00">February 05, 2016</time></span> <span class="excerpt">I was looking at a sample of malware and I wanted to highlight a very simple technique I used to remove a layer of encryption without knowing the key. This post is not going to impress the seasoned veterans but since I think it will probably help someone in the community; I will bang out a post on it.</span></a></article></li>
 
  <li><article><a href="http://jon.glass/blog/reviews_mastering_python_forensics/">Review Of Mastering Python Forensics <span class="entry-date"><time datetime="2015-11-24T21:01:16-05:00">November 24, 2015</time></span> <span class="excerpt">On October 30th, Dr. Michael Spreitzenbarth and Dr. Johann Uhrmann released Mastering Python Forensics. Here are a few of my thoughts on it…</span></a></article></li>
 
  <li><article><a href="http://jon.glass/blog/quarantines-junk/">What happens when Windows Defender Quarantines Stuff... <span class="entry-date"><time datetime="2015-11-02T23:34:30-05:00">November 02, 2015</time></span> <span class="excerpt">Recently a colleague of mine asked me what happens in the file system when a malicious file is &quot;quarantined&quot;.</span></a></article></li>
 
  <li><article><a href="http://jon.glass/blog/parsing-chrome-artifacts-with-python-part-3/">Parsing Chrome Artifacts with Python! Part 3 <span class="entry-date"><time datetime="2015-10-25T19:55:08-04:00">October 25, 2015</time></span> <span class="excerpt">Continuing on my mission to bore the crap out of my readers, I took a look at the html local storage databases I discovered in Part One.</span></a></article></li>
 
  <li><article><a href="http://jon.glass/blog/parsing-chrome-artifacts-with-python-part-2/">Parsing Chrome Artifacts with Python! Part 2 <span class="entry-date"><time datetime="2015-10-11T09:28:03-04:00">October 11, 2015</time></span> <span class="excerpt">Continuing on with my riveting series on how to parse the Chrome SQLite files with Python, let&#39;s dig a little deeper into SQL portion by taking a look the History database.</span></a></article></li>
 
  <li><article><a href="http://jon.glass/blog/parses-chrome-stuff-with-python/">Parsing Chrome Artifacts with Python! Part 1 <span class="entry-date"><time datetime="2015-10-08T23:03:41-04:00">October 08, 2015</time></span> <span class="excerpt">I recently googled myself and saw that I had a blog. After several failed guesses at my e-mail address and password, I was able to stumble back in here. For what it is worth, I have been very busy doing some cool stuff at work. Along those lines, I wanted to highlight some tips on Chrome forensics.</span></a></article></li>
 
  <li><article><a href="http://jon.glass/blog/adventure-in-parsing-the-webcachev01-dat/">Adventure in Parsing the WebCacheV01.dat <span class="entry-date"><time datetime="2015-09-28T06:07:59-04:00">September 28, 2015</time></span> <span class="excerpt">So after taking a closer look at the code behind the libesedb I saw where I was going wrong when looking for those long text values. Here is an updated parser for WebCacheV01.dat.</span></a></article></li>
 
  <li><article><a href="http://jon.glass/blog/uses-python-to-encrypt-huge-files/">Use Python to Encrypt Memory Files <span class="entry-date"><time datetime="2015-05-28T23:42:25-04:00">May 28, 2015</time></span> <span class="excerpt">I was looking for a way to quickly encrypt large files in python.</span></a></article></li>
 
  <li><article><a href="http://jon.glass/blog/analyzes-dridex-malware-p2/">My analysis of Dridex malware (Part Two) <span class="entry-date"><time datetime="2015-03-23T19:01:16-04:00">March 23, 2015</time></span> <span class="excerpt">In the last post, I analyzed a dropper associated with Dridex. This post will focus on analyzing the assa.exe that was dropped.</span></a></article></li>
 
  <li><article><a href="http://jon.glass/blog/analyzes-dridex-malware-p1/">My analysis of Dridex malware (Part One) <span class="entry-date"><time datetime="2015-03-20T11:11:48-04:00">March 20, 2015</time></span> <span class="excerpt">I had a few unscripted hours to kill before bed so I snagged a Dridex sample from Malwr.com to see what all of the fuss was about.</span></a></article></li>
 
  <li><article><a href="http://jon.glass/blog/lists-some-wmic-commands/">These Aren't Yo Momma's WMIC Commands <span class="entry-date"><time datetime="2015-03-13T15:48:48-04:00">March 13, 2015</time></span> <span class="excerpt">I outright stole most of this off of @nbaronian but I plan on updating this post with more as they come to me.</span></a></article></li>
 
  <li><article><a href="http://jon.glass/blog/34-file-entries-on-a-brand-new-mft/">34 File Entries on a Brand New $MFT <span class="entry-date"><time datetime="2015-03-02T21:51:08-05:00">March 02, 2015</time></span> <span class="excerpt">So recently there was a request on a DFIR mailing list about recovering $MFT FILE records.That got me thinking about the creation of the $MFT so I added a new virtual drive to a VM and formatted it.</span></a></article></li>
 
  <li><article><a href="http://jon.glass/blog/examines-usb-transfer-cable/">Evidence of USB Transfer Cable <span class="entry-date"><time datetime="2015-02-27T22:07:21-05:00">February 27, 2015</time></span> <span class="excerpt">Recently my local RadioShack had a huge &quot;Going Out of Business&quot; sale. So I grabbed a few things I that looked interesting. Among those items was a RadioShack USB Transfer Cable for Windows and Mac.</span></a></article></li>
 
  <li><article><a href="http://jon.glass/blog/notes-about-windows-process-ids/">Useless Trivia about Windows Process IDs <span class="entry-date"><time datetime="2015-02-20T11:05:14-05:00">February 20, 2015</time></span> <span class="excerpt">Here are somethings I discovered about Windows Process IDs that I did not previously know...</span></a></article></li>
 
  <li><article><a href="http://jon.glass/blog/mass-undelete-from-the-recycle-bin/">Mass Undelete from the Recycle Bin <span class="entry-date"><time datetime="2015-02-20T11:03:47-05:00">February 20, 2015</time></span> <span class="excerpt">This is more &quot;e-discovery&quot; than forensics but I recently had a case where I needed to 1,300 files that were in a user&#39;s Recycle Bin.It was not overly important to the user’s management when they were originally created or when it was deleted. They just wanted to review the documents. So I took an hour and hammered out this beast.&lt;/p&gt;</span></a></article></li>
 
  <li><article><a href="http://jon.glass/blog/posts-a-few-sysmonmaps-for-referrence/">A Few SysmonMaps for Referrence <span class="entry-date"><time datetime="2015-02-17T08:08:59-05:00">February 17, 2015</time></span> <span class="excerpt">This post is mostly for me but you can read it if you want.Here are maps I created with SysInternals Sysmon, Google&#39;s Org Chart API and fistfuls of Javascript and PowerShell.Win7SysmonMapWin8 SysmonMapWin10 TP SysmonMapWin10 TP SysmonMap w/PID collisionWin10x64</span></a></article></li>
 
  <li><article><a href="http://jon.glass/blog/looks-at-the-win10-boot-process/">The magic trick I discovered in the Windows 10 boot process... <span class="entry-date"><time datetime="2015-02-16T22:03:50-05:00">February 16, 2015</time></span> <span class="excerpt">So there I was, at the tail end of a RaDFIRe presentation that I barely had time to make much less review, trying to demonstrate how similar the Windows 7, 8, and 10 Tech Preview boot operations were when I brought up the SysmonMap for Windows 10. It was different from the rest and it threw me for a loop in front of a crowd. I will explain the difference I noticed.Long before time began, there was Windows 3.1. Windows 3.1 introduced the Session Manager Subsystem (SMSS.EXE). SMSS.EXE is responsible for a few things: creating page files and environment variables, creating DOS device mappings like LPT1, and most importantly it creates the Kernel mode (WIN32K.SYS) and User mode (CSRSS.EXE) of the Win32 subsystem. The important difference between the two is that Kernel mode processes were allowed to talk, through device drivers, directly to hardware devices whereas User mode processes have to use Windows API calls to indirectly talk to hardware. Many of the security problems with early versions of Windows stemmed from allowing services and user applications to run in the same session.To establish a greater rift between user and system mode processes, starting in Windows Vista, SMSS creates two copies of itself on boot. The first instance of SMSS is used to run Session 0 and is reserved exclusively for services and other non-interactive user applications. Session 0 is used to launch operating system and background processes like Local Session Manager Service (LSM), Local Security Authority (LSA), and Services Controller Manager (SCM) to name a few. Most importantly, this is the session that all services are run in. This second screenshot is what a Windows 8 Session 0 SMSS.EXE looks like on a SysmonMap. This is something to look for in &quot;Know normal, Find Evil&quot; category. Like the Highlander, there can (should) be only ONE SMSS.EXE running. For sessions higher than 0, a SMSS.EXE is launched but it terminates once WINLOGON.EXE is running. If you have more than one SMSS.EXE running on your system...you have a problem.Users who are logged on to Windows and their user applications must run in Session 1 or higher. Session 0 no longer support User interfaces. In fact, processes running in Session 0 have no access to the graphics hardware thus user interfaces cannot be directly displayed on the monitor.Don&#39;t believe me? Try this:Download PsExec from Microsoft SysInternals site.Run psexec.exe -s -d calc.exe to run calc.exe in Session 0.You won&#39;t see the calculator window pop up but it is running.You can check with WMIC to see what sessionid it is running under as well.Looks like this:The second instance of SMSS establishes Session 1 and supports interactive User processes. Every additional concurrent user gets their own Session. So if I logon into a server over RDP after someone else is already logged on, my Session ID will be higher than 1. This is an interesting artifact to review when establishing attribution of running processes. While sessions are designed to partition the processes of concurrent users, it is pretty easy to run a process in another session.If I logged in after someone else and wanted an interactive process to appear in their session, all I would need to do is:psexec.exe -i 1 ProcessForLoggedOnUserToSee.exe -i         Run the program so that it interacts with the desktop of the            specified session on the remote system. If no session is            specified the process runs in the console session.Once you stare at enough event logs, behavior like that would stick out if you know what to look for. While this information might seem off topic, I will bring it all full circle.Back to the Windows 10... Here is theWin10 Tech Preview SysmonMap I was displaying to the crowd. It is a bit busy to look at but here is the condensed version. So just as with Vista/7/8, SMSS launched two instances of itself to create Session 0 and Session 1 but, in Windows 10 the client session SMSS.EXE apparently doesn&#39;t directly start any processes. Instead, an Session 0 SVCHOST.EXE is used to launch WINLOGON.EXE? This can&#39;t be right. Let&#39;s dig a little deeper...Here is the XML for the SMSS.EXE process creation as logged by Sysmon:Notice the PID of 660, image of &quot;C:\Windows\System32\smss.exe&quot; and the GUID of 66AE7ABA-04DC-54DD-0000-001055930000Now lets look at the XML for the WINLOGON.EXE process creation:Take a look at the ParentProcess.The PID is the 660The GUID is the 66AE7ABA-04DD-54DD-0000-0010CC300100?!The image is... SVCHOST.EXE?!MIND. BLOWN.That is some David Copperfield shit there.I am not sure what happened here but questions abound:1. Is this magic trick something that is new with Windows 10? I can&#39;t imagine a purpose for a change like this.2. Is this an artifact of the Windows Boot sequence that I don&#39;t fully understand? Maybe.3. Is this a Sysmon logging error? If this is an error on Sysmon&#39;s side, it is the first major SNAFU I have encountered.4. Is this an quirk of a half-baked Tech Preview? Could be.My money is riding on some combination of 3 and 4.I would not have found whatever this is if I had not recently made a change in my SysmonMapper script.I was binding parent processes to child processes using processids BUT that leads to erroneous results across reboots because everything maps back to pid 4 every time. Instead I chose GUIDs because it allows the script to handle start ups and shut downs throughout the time frame of the query. Once I get the new code presentable I will put it up here. Currently it is functional but looks like a toddler wrote it.Since I have run out of things to say about this subject, this is where I leave you. If an answer comes forth to explain this prestidigitation, I will put all of your minds at ease and post it as an update here. If you can shed some light on this, hit me up in the comments section or on Twitter.*******UPDATE***********Reading further into the logs I found the event for SVCHOST.EXE launching:Things are starting to become a bit clearer. So far I can tell thatAt 19:54:14.351173000Z, SMSS.EXE starts with PID 660.At 19:54:14.366799500Z, WINLOGON.EXE starts.At 19:54:14.569924800Z, SVCHOST.EXE starts with 660 starts.At 19:54:15.335550000Z, SYSMON.EXE starts up.The Sysmon logs show that SVCHOST.EXE as the parent process for WINLOGON.EXE but since SVCHOST.EXE hadn&#39;t started yet this is clearly an error.What happened was a PID collision. Here is how it actually went down:1. SMSS.EXE starts up with PID 6602. SMSS.EXE launches WINLOGON.EXE just like Windows Vista/7/83. Once WINLOGON.EXE is running, the Session 1 SMSS.EXE terminates and releases PID 660 back into the pool of available pid numbers.4. SVCHOST.EXE starts up and grabs PID 660.5. Sysmon starts up and sees the Parent PID for WINLOGON.EXE is 660 and the current PID for SVCHOST is 660 and makes a reasonable guess.This is explains EVERYTHING. It also highlights how Sysmon documents things that occur before it is running to see them. Good stuff. So no magic here, just Sysmon erroneously logging based off of a PID collision. </span></a></article></li>
 
  <li><article><a href="http://jon.glass/blog/discusses-sysmon-v2-filtering-rules/">How to Use Sysmon 2.0 (Part 2) <span class="entry-date"><time datetime="2015-02-02T22:33:48-05:00">February 02, 2015</time></span> <span class="excerpt">Sysmon 2.0 Rule filteringIf you have used Sysmon for any extended length of time, you already know that the logs fill up quick. This is the nature of Windows. There is a lot going on under the hood. If you configure Sysmon to log when processes create network connections (Event ID 3) and load modules (Event ID 7), you are going to record more logs than you want to read.To help add granularity, 2.0 comes with the ability to filter events based off a flexible ruleset. This is implemented through an XML configuration file that can be applied during installation and changed any time. The configuration commands can be found on the SysInternals&#39; Sysmon page. Here is an example of a basic configuration file w/some notes:The XML file is broken into to two sections Configuration and Rules.The Configuration section provides for the same options config options from the command line.-h Configuration entry: Hashing-l Configuration entry: ImageLoading-n Configuration entry: NetworkThe Rules section allows you to configure which events you want to include/exclude.Making rules are pretty easy:Pick a Sysmon Event you want to include/exclude in the logs.ID	Tag	           Event1	ProcessCreate	   Process Create2	FileCreateTime	   File creation time3	NetworkConnect	   Network connection detected5	ProcessTerminate   Process terminated6	DriverLoad	   Driver Loaded7	ImageLoad	   Image loadedLets say I want to focus on Event ID 2 events so I will use the &quot;NetworkConnect&quot; tag.Determine if you are want to use this rule to include or exclude something.This might be the most confusing part but fear not, I will lead you through.A Sysmon rule asks for a default action to apply to all events of that type. To Log (include) or not to Log (exclude), that is the question. Once you have established the default action, you include conditional statements that act as exceptions to the default action. So if the default action is to INCLUDE, all of the conditions in the rule will be used to EXCLUDE events from the log. The opposite is also true, if the default action is to EXCLUDE, all of the conditions in the rule will be used to INCLUDE events in the log.Cast an appropriate net.This is where Sysmon shines. If you are configuring Sysmon monitor something specific, these new rules afford that level of granularity. Inversely, you can increase the Signal-to-Noise ratio and not log noisy known good processes (antivirus, binaries with specific hashes, etc).This is an example of a configuration file to observe the specific actions of a particular malware:Here is a random example I pulled from the good people at malwr.com.Here is a Sysmon configuration file that could be used to monitor most of the behavior. (This is not exhaustive, just an example of potential use.)Using Sysmon for something this specific is great but when you are staring at trees, you are going to miss the forest. Here is an example of how to use Sysmon as an everyday background service that monitors everything EXCEPT for processes that you would rather not see cluttering up your logs.&lt;/ol&gt;The seriously useful part about the configuration file is that you can load a new one at anytime.C:\Windows\System32&gt;sysmon.exe -c OnlyLookAtOneThing.xmlC:\Windows\System32&gt;sysmon.exe -c DontLogPornHubTraffic.xmlThis makes Sysmon very deployable and scalable. Personally, on most of my machines, I typically run Sysmon wide open, without any restriction on what to log unless I want to document something specific. I also increase the log size to something ridiculous like 200 MB.wevtutil sl Microsoft-Windows-Sysmon/Operational /ms:209715200</span></a></article></li>
 
  <li><article><a href="http://jon.glass/blog/discusses-sysmon-v2/">How to Use Sysmon 2.0 (Part 1) <span class="entry-date"><time datetime="2015-01-21T11:09:07-05:00">January 21, 2015</time></span> <span class="excerpt">On January 19, 2015, the SysInternals team released Sysmon 2.0. &quot;This major update to Sysmon, a service that records process activity to the Windows event log for use by incident detection and forensic analysis, includes driver load and image load events with signature information, configurable hashing algorithm reporting, flexible filters for including and excluding events, and support for supplying configuration via a configuration file instead of the command line.&quot;One interesting update in 2.0 is the addition of Import Hashes (imphash).If you are not familiar, imports are the functions that a piece of software calls from other files. Most of the time, imports are used to augment a program with a function from a Windows DLL. Imphashes are calculated by based on library/API names and their specific order within the executable. Imphashes are useful for tracking flavors of malware that use the same functionality but have different binaries. This addition separates Sysmon from being an augmentation of Windows event logging to a utility that is designed to analyze malware. Awesome.2.0 also comes with 5 new events:Event ID 4: Sysmon service state changedThe service state change event reports the state of the Sysmon service (started or stopped).&lt;Event xmlns=&quot;http://schemas.microsoft.com/win/2004/08/events/event&quot;&gt;  &lt;System&gt;    &lt;Provider Name=&quot;Microsoft-Windows-Sysmon&quot; Guid=&quot;{5770385F-C22A-43E0-BF4C-06F5698FFBD9}&quot; /&gt;    &lt;EventID&gt;4&lt;/EventID&gt;    &lt;Version&gt;1&lt;/Version&gt;    &lt;Level&gt;4&lt;/Level&gt;    &lt;Task&gt;4&lt;/Task&gt;    &lt;Opcode&gt;0&lt;/Opcode&gt;    &lt;Keywords&gt;0x8000000000000000&lt;/Keywords&gt;    &lt;TimeCreated SystemTime=&quot;2015-01-21T16:54:43.336928400Z&quot; /&gt;    &lt;EventRecordID&gt;216242&lt;/EventRecordID&gt;    &lt;Correlation /&gt;    &lt;Execution ProcessID=&quot;1112&quot; ThreadID=&quot;1168&quot; /&gt;    &lt;Channel&gt;Microsoft-Windows-Sysmon/Operational&lt;/Channel&gt;    &lt;Computer&gt;WIN-RKSC06DQ86F&lt;/Computer&gt;    &lt;Security UserID=&quot;S-1-5-18&quot; /&gt;  &lt;/System&gt;  &lt;EventData&gt;    &lt;Data Name=&quot;State&quot;&gt;Started&lt;/Data&gt;  &lt;/EventData&gt;&lt;/Event&gt;Event ID 5: Process terminatedThe process terminate event reports when a process terminates. It provides the UtcTime, ProcessGuid and ProcessId of the process.&lt;Event xmlns=&quot;http://schemas.microsoft.com/win/2004/08/events/event&quot;&gt;  &lt;System&gt;    &lt;Provider Name=&quot;Microsoft-Windows-Sysmon&quot; Guid=&quot;{5770385F-C22A-43E0-BF4C-06F5698FFBD9}&quot; /&gt;    &lt;EventID&gt;5&lt;/EventID&gt;    &lt;Version&gt;1&lt;/Version&gt;    &lt;Level&gt;4&lt;/Level&gt;    &lt;Task&gt;5&lt;/Task&gt;    &lt;Opcode&gt;0&lt;/Opcode&gt;    &lt;Keywords&gt;0x8000000000000000&lt;/Keywords&gt;    &lt;TimeCreated SystemTime=&quot;2015-01-21T17:00:43.600396700Z&quot; /&gt;    &lt;EventRecordID&gt;277158&lt;/EventRecordID&gt;    &lt;Correlation /&gt;    &lt;Execution ProcessID=&quot;1112&quot; ThreadID=&quot;1332&quot; /&gt;    &lt;Channel&gt;Microsoft-Windows-Sysmon/Operational&lt;/Channel&gt;    &lt;Computer&gt;WIN-RKSC06DQ86F&lt;/Computer&gt;    &lt;Security UserID=&quot;S-1-5-18&quot; /&gt;  &lt;/System&gt;  &lt;EventData&gt;    &lt;Data Name=&quot;UtcTime&quot;&gt;1/21/2015 05:00:43.481 PM&lt;/Data&gt;    &lt;Data Name=&quot;ProcessGuid&quot;&gt;{FF1717CF-DB0B-54BF-0000-001015761600}&lt;/Data&gt;    &lt;Data Name=&quot;ProcessId&quot;&gt;10096&lt;/Data&gt;  &lt;/EventData&gt;&lt;/Event&gt;Event ID 6: Driver loadedThe driver loaded events provides information about a driver being loaded on the system. The configured hashes are provided as well as signature information. The signature is done asynchronously for performance reasons and indicates if the file was removed after loading.&lt;Event xmlns=&quot;http://schemas.microsoft.com/win/2004/08/events/event&quot;&gt;  &lt;System&gt;    &lt;Provider Name=&quot;Microsoft-Windows-Sysmon&quot; Guid=&quot;{5770385F-C22A-43E0-BF4C-06F5698FFBD9}&quot; /&gt;    &lt;EventID&gt;6&lt;/EventID&gt;    &lt;Version&gt;1&lt;/Version&gt;    &lt;Level&gt;4&lt;/Level&gt;    &lt;Task&gt;6&lt;/Task&gt;    &lt;Opcode&gt;0&lt;/Opcode&gt;    &lt;Keywords&gt;0x8000000000000000&lt;/Keywords&gt;    &lt;TimeCreated SystemTime=&quot;2015-01-21T16:54:54.924095100Z&quot; /&gt;    &lt;EventRecordID&gt;218132&lt;/EventRecordID&gt;    &lt;Correlation /&gt;    &lt;Execution ProcessID=&quot;1112&quot; ThreadID=&quot;1336&quot; /&gt;    &lt;Channel&gt;Microsoft-Windows-Sysmon/Operational&lt;/Channel&gt;    &lt;Computer&gt;WIN-RKSC06DQ86F&lt;/Computer&gt;    &lt;Security UserID=&quot;S-1-5-18&quot; /&gt;  &lt;/System&gt;  &lt;EventData&gt;    &lt;Data Name=&quot;UtcTime&quot;&gt;1/21/2015 04:54:47.299 PM&lt;/Data&gt;    &lt;Data Name=&quot;ImageLoaded&quot;&gt;C:\Windows\System32\drivers\WdNisDrv.sys&lt;/Data&gt;    &lt;Data Name=&quot;HashType&quot;&gt;SHA1,MD5,SHA256,IMPHASH&lt;/Data&gt;    &lt;Data Name=&quot;Hash&quot;&gt;9F469B3BA78F83D1F8B73B4F6EFD365F92A89786,282E7D46310338FF4A6B7680440EB0DA,04242798DD82F583154AEA3D775C9BFD574FC471D01CDEB9D070872425094D82,FEC15D772A16260D523B3D2E2797F735&lt;/Data&gt;    &lt;Data Name=&quot;Signed&quot;&gt;true&lt;/Data&gt;    &lt;Data Name=&quot;Signature&quot;&gt;Microsoft Windows&lt;/Data&gt;  &lt;/EventData&gt;&lt;/Event&gt;Event ID 7: Image loadedThe image loaded event logs when a module is loaded in a specific process. This event is disabled by default and needs to be configured with the –l option. It indicates the process in which the module is loaded, hashes and signature information.  The signature is done asynchronously for performance reasons and indicates if the file was removed after loading. This event should be configured carefully, as monitoring all image load events will generate a large number of events.&lt;Event xmlns=&quot;http://schemas.microsoft.com/win/2004/08/events/event&quot;&gt;  &lt;System&gt;    &lt;Provider Name=&quot;Microsoft-Windows-Sysmon&quot; Guid=&quot;{5770385F-C22A-43E0-BF4C-06F5698FFBD9}&quot; /&gt;    &lt;EventID&gt;7&lt;/EventID&gt;    &lt;Version&gt;1&lt;/Version&gt;    &lt;Level&gt;4&lt;/Level&gt;    &lt;Task&gt;7&lt;/Task&gt;    &lt;Opcode&gt;0&lt;/Opcode&gt;    &lt;Keywords&gt;0x8000000000000000&lt;/Keywords&gt;    &lt;TimeCreated SystemTime=&quot;2015-01-21T17:00:43.977452900Z&quot; /&gt;    &lt;EventRecordID&gt;277336&lt;/EventRecordID&gt;    &lt;Correlation /&gt;    &lt;Execution ProcessID=&quot;1112&quot; ThreadID=&quot;1332&quot; /&gt;    &lt;Channel&gt;Microsoft-Windows-Sysmon/Operational&lt;/Channel&gt;    &lt;Computer&gt;WIN-RKSC06DQ86F&lt;/Computer&gt;    &lt;Security UserID=&quot;S-1-5-18&quot; /&gt;  &lt;/System&gt;  &lt;EventData&gt;    &lt;Data Name=&quot;UtcTime&quot;&gt;1/21/2015 05:00:43.789 PM&lt;/Data&gt;    &lt;Data Name=&quot;ProcessGuid&quot;&gt;{FF1717CF-DB37-54BF-0000-001008982000}&lt;/Data&gt;    &lt;Data Name=&quot;ProcessId&quot;&gt;41744&lt;/Data&gt;    &lt;Data Name=&quot;Image&quot;&gt;C:\Windows\System32\cmd.exe&lt;/Data&gt;    &lt;Data Name=&quot;ImageLoaded&quot;&gt;C:\Windows\System32\advapi32.dll&lt;/Data&gt;    &lt;Data Name=&quot;HashType&quot;&gt;SHA1,MD5,SHA256,IMPHASH&lt;/Data&gt;    &lt;Data Name=&quot;Hash&quot;&gt;C446DE5692D5CA9B7DAEE0F0A48FC6A575F8FE3A,561F1AB95F4F01C691BDABA5FD5C67FC,4C6184C1A72B2F84BB1CA5A72F89CC44F9F37FF225D834EBCEFF26F820635BED,973A8CDB39A3DB10C284AFB640B793B3&lt;/Data&gt;    &lt;Data Name=&quot;Signed&quot;&gt;true&lt;/Data&gt;    &lt;Data Name=&quot;Signature&quot;&gt;Microsoft Windows&lt;/Data&gt;  &lt;/EventData&gt;&lt;/Event&gt;Event ID 255: ErrorThis event is generated when an error occurred within Sysmon. They can happen if the system is under heavy load and certain tasked could not be performed or a bug exists in the Sysmon service.&lt;Event xmlns=&quot;http://schemas.microsoft.com/win/2004/08/events/event&quot;&gt;  &lt;System&gt;    &lt;Provider Name=&quot;Microsoft-Windows-Sysmon&quot; Guid=&quot;{5770385F-C22A-43E0-BF4C-06F5698FFBD9}&quot; /&gt;    &lt;EventID&gt;255&lt;/EventID&gt;    &lt;Version&gt;1&lt;/Version&gt;    &lt;Level&gt;2&lt;/Level&gt;    &lt;Task&gt;255&lt;/Task&gt;    &lt;Opcode&gt;0&lt;/Opcode&gt;    &lt;Keywords&gt;0x8000000000000000&lt;/Keywords&gt;    &lt;TimeCreated SystemTime=&quot;2015-01-21T17:00:44.001453300Z&quot; /&gt;    &lt;EventRecordID&gt;278772&lt;/EventRecordID&gt;    &lt;Correlation /&gt;    &lt;Execution ProcessID=&quot;1112&quot; ThreadID=&quot;1332&quot; /&gt;    &lt;Channel&gt;Microsoft-Windows-Sysmon/Operational&lt;/Channel&gt;    &lt;Computer&gt;WIN-RKSC06DQ86F&lt;/Computer&gt;    &lt;Security UserID=&quot;S-1-5-18&quot; /&gt;  &lt;/System&gt;  &lt;EventData&gt;    &lt;Data Name=&quot;ID&quot;&gt;DriverCommunication&lt;/Data&gt;    &lt;Data Name=&quot;Description&quot;&gt;Failed to retrieve events (Last error: Insufficient system resources exist to complete the requested service.).&lt;/Data&gt;  &lt;/EventData&gt;&lt;/Event&gt;Took me a second to get Sysmon to throw an error like this. It is worthy to note that, from my observations, Sysmon is not prone to error under normal use. In case anyone is wondering how to make Sysmon barf (along with the rest of the computer) I used an old school fork logic bomb batch script as a means to an end. Drop this into a batch file and run it. THIS WILL LOCK UP YOUR ENTIRE SYSTEM QUICK. You have been told.:STARTstart %~dp0%~n0%~x0%~dp0%~n0%~x0|%~dp0%~n0%~x0GOTO STARTI am sure there are more elegant ways but this was the first idea that came to mind that worked.Sysmon 2.0 also has a filtering feature that I will cover in the next post.</span></a></article></li>
 
  <li><article><a href="http://jon.glass/blog/sharpening-the-acks/">Sharpening The ACKs? <span class="entry-date"><time datetime="2013-03-29T15:24:43-04:00">March 29, 2013</time></span> <span class="excerpt">I heard a famous quote from Lincoln a while ago and it basically summaries the point of this blog.Give me six hours to chop down a tree and I will spend the first four sharpening the axe.I hope to use this a means to document my various attempts to master IT security. This is going to be my personal resource to reference for things I find noteworthy on the net or things I have tried that are worth documenting or doing again. The first few posts I plan on doing are about my lab setup at home. It is shaping up to be pretty spiffy. From there I plan on posting something at least once a week or so to justify the blog&#39;s existence and keep me motivated. We&#39;ll see where this goes.For those of you that don&#39;t know why I spelled ax wrong, feel free to bone up on TCP/IP.</span></a></article></li>

</ul>

      </div><!-- /.entry-content -->
    </div><!-- /.entry-wrapper -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo" class="entry-wrapper">
    

<span>&copy; 2017 Jon Glass. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="https://mademistakes.com/work/so-simple-jekyll-theme/" rel="nofollow">So Simple Theme</a>.</span>
<div class="social-icons">
	<a href="https://twitter.com/GlassDFIR" title="Jon Glass on Twitter" target="_blank"><i class="fa fa-twitter-square fa-2x"></i></a>
	
	
	
	
	
	
	<a href="https://github.com/GlassDFIR" title="Jon Glass on Github" target="_blank"><i class="fa fa-github-square fa-2x"></i></a>
	
  
	
  <a href="http://jon.glass/feed.xml" title="Atom/RSS feed"><i class="fa fa-rss-square fa-2x"></i></a>
</div><!-- /.social-icons -->

  </footer>
</div><!-- /.footer-wrapper -->

<script type="text/javascript">
  var BASE_URL = 'http://jon.glass';
</script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://jon.glass/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://jon.glass/assets/js/scripts.min.js"></script>




</body>
</html>
