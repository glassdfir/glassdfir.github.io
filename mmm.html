<html>

  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
      p,table {
        text-align: center;
        font-size: 5vw;
        margin-top: 0px;
      }

    </style>
  </head>

  <body>
    <p id="demo"></p>

    <script>
      var startofmarathon = new Date("Aug 28, 2018 08:00");
      var savings = 8 + 30 + 4 + 15 + 16 +13;
      var movies = new Array();
      movies[0] = new Array('Iron Man', 118, 'https://m.media-amazon.com/images/M/MV5BMTczNTI2ODUwOF5BMl5BanBnXkFtZTcwMTU0NTIzMw@@._V1_SY1000_CR0,0,674,1000_AL_.jpg');
      movies[1] = new Array('The Incredible Hulk', 261, 'https://m.media-amazon.com/images/M/MV5BMTUyNzk3MjA1OF5BMl5BanBnXkFtZTcwMTE1Njg2MQ@@._V1_SY1000_CR0,0,674,1000_AL_.jpg');
      movies[2] = new Array('Iron Man 2', 385, 'https://m.media-amazon.com/images/M/MV5BMTM0MDgwNjMyMl5BMl5BanBnXkFtZTcwNTg3NzAzMw@@._V1_.jpg');
      movies[3] = new Array('Thor', 500, 'https://m.media-amazon.com/images/M/MV5BOGE4NzU1YTAtNzA3Mi00ZTA2LTg2YmYtMDJmMThiMjlkYjg2XkEyXkFqcGdeQXVyNTgzMDMzMTg@._V1_SY1000_CR0,0,674,1000_AL_.jpg');
      movies[4] = new Array('Captain America The First Avenger', 625, 'https://m.media-amazon.com/images/M/MV5BMTYzOTc2NzU3N15BMl5BanBnXkFtZTcwNjY3MDE3NQ@@._V1_SY1000_CR0,0,640,1000_AL_.jpg');
      movies[5] = new Array('The Avengers', 768, 'https://m.media-amazon.com/images/M/MV5BNDYxNjQyMjAtNTdiOS00NGYwLWFmNTAtNThmYjU5ZGI2YTI1XkEyXkFqcGdeQXVyMTMxODk2OTU@._V1_SY1000_CR0,0,675,1000_AL_.jpg');
      movies[6] = new Array('Iron Man 3', 903, 'https://m.media-amazon.com/images/M/MV5BMjE5MzcyNjk1M15BMl5BanBnXkFtZTcwMjQ4MjcxOQ@@._V1_SY1000_SX700_AL_.jpg');
      movies[7] = new Array('Thor: The Dark World', 1015, 'https://m.media-amazon.com/images/M/MV5BMTQyNzAwOTUxOF5BMl5BanBnXkFtZTcwMTE0OTc5OQ@@._V1_SY1000_SX700_AL_.jpg');
      movies[8] = new Array('Captain America: The Winter Soldier', 1121, 'https://m.media-amazon.com/images/M/MV5BMzA2NDkwODAwM15BMl5BanBnXkFtZTgwODk5MTgzMTE@._V1_SY1000_CR0,0,685,1000_AL_.jpg');
      movies[9] = new Array('Guardians of the Galaxy', 1276, 'https://m.media-amazon.com/images/M/MV5BMTAwMjU5OTgxNjZeQTJeQWpwZ15BbWU4MDUxNDYxODEx._V1_SY1000_CR0,0,674,1000_AL_.jpg');
      movies[10] = new Array('Avengers: Age of Ultron', 1406, 'https://m.media-amazon.com/images/M/MV5BMTM4OGJmNWMtOTM4Ni00NTE3LTg3MDItZmQxYjc4N2JhNmUxXkEyXkFqcGdeQXVyNTgzMDMzMTg@._V1_SY1000_SX675_AL_.jpg');
      movies[11] = new Array('Ant-Man', 1516, 'https://m.media-amazon.com/images/M/MV5BMjM2NTQ5Mzc2M15BMl5BanBnXkFtZTgwNTcxMDI2NTE@._V1_.jpg');
      movies[12] = new Array('Captain America: Civil War', 1652, 'https://m.media-amazon.com/images/M/MV5BMjQ0MTgyNjAxMV5BMl5BanBnXkFtZTgwNjUzMDkyODE@._V1_SY1000_CR0,0,674,1000_AL_.jpg');
      movies[13] = new Array('Doctor Strange', 1787, 'https://m.media-amazon.com/images/M/MV5BNjgwNzAzNjk1Nl5BMl5BanBnXkFtZTgwMzQ2NjI1OTE@._V1_SY1000_CR0,0,674,1000_AL_.jpg');
      movies[14] = new Array('Guardians of the Galaxy Vol.2', 1937, 'https://m.media-amazon.com/images/M/MV5BMTg2MzI1MTg3OF5BMl5BanBnXkFtZTgwNTU3NDA2MTI@._V1_SY1000_CR0,0,674,1000_AL_.jpg');
      movies[15] = new Array('Spider-Man: Homecoming', 2070, 'https://m.media-amazon.com/images/M/MV5BNTk4ODQ1MzgzNl5BMl5BanBnXkFtZTgwMTMyMzM4MTI@._V1_SY1000_CR0,0,658,1000_AL_.jpg');
      movies[16] = new Array('Thor: Ragnarok', 2200, 'https://m.media-amazon.com/images/M/MV5BMjMyNDkzMzI1OF5BMl5BanBnXkFtZTgwODcxODg5MjI@._V1_SY1000_CR0,0,674,1000_AL_.jpg');
      movies[17] = new Array('Black Panther', 2335, 'https://m.media-amazon.com/images/M/MV5BMTg1MTY2MjYzNV5BMl5BanBnXkFtZTgwMTc4NTMwNDI@._V1_SY1000_CR0,0,674,1000_AL_.jpg');
      movies[18] = new Array('Avengers : Infinity War', 2495, 'https://m.media-amazon.com/images/M/MV5BMjMxNjY2MDU1OV5BMl5BanBnXkFtZTgwNzY1MTUwNTM@._V1_SY1000_CR0,0,674,1000_AL_.jpg');
      movies[19] = new Array('Sleep', 0, "https://www.kayhealdhr.co.uk/wp-content/uploads/2017/03/sleep2.png");

      // Set the date we're counting down to
      function diff_minutes(dt2, dt1) {
        var diff = (dt2.getTime() - dt1.getTime()) / 1000;
        diff /= 60;
        return Math.abs(Math.round(diff));
      }

      function refreshdisplay(countDownDate, indexnum) {
        var x = setInterval(function() {
          // Get todays date and time
          var startofmarathon = new Date("Aug 28, 2018 08:00");
          var now = new Date().getTime();
          var distance =  countDownDate-now;
          var sincemoviestart = now-countDownDate;
          var moviehours = Math.floor((sincemoviestart % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
          var movieminutes = Math.floor((sincemoviestart % (1000 * 60 * 60)) / (1000 * 60));
          var movieseconds = Math.floor((sincemoviestart % (1000 * 60)) / 1000);

          var totaldistance = now-startofmarathon;  var days = Math.floor(totaldistance / (1000 * 60 * 60 * 24));

          var totalhours = Math.floor((totaldistance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
          var totalminutes = Math.floor((totaldistance % (1000 * 60 * 60)) / (1000 * 60));
          var totalseconds = Math.floor((totaldistance % (1000 * 60)) / 1000);
          // Time calculations for days, hours, minutes and seconds
          var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
          var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
          var seconds = Math.floor((distance % (1000 * 60)) / 1000);
          // Display the result in the element with id="demo"
          document.getElementById("demo").innerHTML = 
            "Marvel Movie Marathon<br><table><tr>" +
            "<td>Now Playing<br><img src=" + movies[indexnum][2] + " width='50%'></td><td>" + movies[indexnum][0] + "</td>" +
            "</tr>" +
            "<tr><td>Up Next<br><img src=" + movies[indexnum + 1][2] + " width='50%'></td><td>Time Until Next Movie:<br>" + hours + "h " + minutes + "m " + seconds + "s </td>" +
            "</tr>" +
            "<tr><td>Total Marathon Time</td><td>" + days + "d " + totalhours + "h " + totalminutes + "m " + totalseconds + "s </td></tr>" +
            "</table>";

          // If the count down is finished, write some text 
          if (distance < 0) {
            clearInterval(x);
            load();
          }
        }, 1000);


      };

      function load() {
        var nextmovie = startofmarathon;
        var now = new Date();
        
        var minsfromstart = diff_minutes(now, startofmarathon)
        console.log("mins from start = " + minsfromstart);
        if (minsfromstart < movies[0][1] - 8) {nextmovie.setMinutes(startofmarathon.getMinutes() + movies[0][1] - 8);refreshdisplay(nextmovie, 0);} else
        if (minsfromstart < movies[1][1] - 30) {nextmovie.setMinutes(startofmarathon.getMinutes() + movies[1][1] - 30);refreshdisplay(nextmovie, 1);} else
        if (minsfromstart < movies[2][1] - 14) {nextmovie.setMinutes(startofmarathon.getMinutes() + movies[2][1] - 14);refreshdisplay(nextmovie, 2);} else
        if (minsfromstart < movies[3][1] - 50) {nextmovie.setMinutes(startofmarathon.getMinutes() + movies[3][1] - 10);refreshdisplay(nextmovie, 3);} else
        if (minsfromstart < movies[4][1] - 56) {nextmovie.setMinutes(startofmarathon.getMinutes() + movies[4][1] - 56);refreshdisplay(nextmovie, 4);} else
        if (minsfromstart < movies[5][1] - 69) {nextmovie.setMinutes(startofmarathon.getMinutes() + movies[5][1] - 69);refreshdisplay(nextmovie, 5);} else
        if (minsfromstart < movies[6][1] - 90) {nextmovie.setMinutes(startofmarathon.getMinutes() + movies[6][1] - 90);refreshdisplay(nextmovie, 6);} else
        if (minsfromstart < movies[7][1]- 102) {nextmovie.setMinutes(startofmarathon.getMinutes() + movies[7][1] - 102);refreshdisplay(nextmovie, 7);} else
        if (minsfromstart < movies[8][1]- 115) {nextmovie.setMinutes(startofmarathon.getMinutes() + movies[8][1] - 115);refreshdisplay(nextmovie, 8);} else
        if (minsfromstart < movies[9][1] -107) {nextmovie.setMinutes(startofmarathon.getMinutes() + movies[9][1] - 107);refreshdisplay(nextmovie, 9);} else
        if (minsfromstart < movies[10][1]-107) {nextmovie.setMinutes(startofmarathon.getMinutes() + movies[10][1] - 107);refreshdisplay(nextmovie, 10);} else
        if (minsfromstart < movies[11][1]-113) {nextmovie.setMinutes(startofmarathon.getMinutes() + movies[11][1] - 113);refreshdisplay(nextmovie, 11);} else
        if (minsfromstart < movies[12][1]-113) {nextmovie.setMinutes(startofmarathon.getMinutes() + movies[12][1] - 113);refreshdisplay(nextmovie, 12);} else
        if (minsfromstart < movies[13][1]-145) {nextmovie.setMinutes(startofmarathon.getMinutes() + movies[13][1] - 145);refreshdisplay(nextmovie, 13);} else
        if (minsfromstart < movies[14][1]-130) {nextmovie.setMinutes(startofmarathon.getMinutes() + movies[14][1] - 130);refreshdisplay(nextmovie, 14);} else
        if (minsfromstart < movies[15][1]) {nextmovie.setMinutes(startofmarathon.getMinutes() + movies[15][1] - savings);refreshdisplay(nextmovie, 15);} else
        if (minsfromstart < movies[16][1]) {nextmovie.setMinutes(startofmarathon.getMinutes() + movies[16][1] - savings);refreshdisplay(nextmovie, 16);} else
        if (minsfromstart < movies[17][1]) {nextmovie.setMinutes(startofmarathon.getMinutes() + movies[17][1] - savings);refreshdisplay(nextmovie, 17);} else
        if (minsfromstart < movies[18][1]) {nextmovie.setMinutes(startofmarathon.getMinutes() + movies[18][1] - savings);refreshdisplay(nextmovie, 18);}
        }
      load();

    </script>
  </body>

</html>
